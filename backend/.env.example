# =====================================================
# BACKEND ENVIRONMENT - SECURITY HARDENED
# =====================================================

# ============================================
# CRITICAL SECURITY SETTINGS
# ============================================

# Application Settings
APP_NAME=PhishingDetector
APP_ENV=production
DEBUG=False

# IP Security (CRITICAL - Prevents IP Spoofing)
TRUSTED_PROXIES=127.0.0.1,localhost
IP_WHITELIST_ENABLED=True

# Authentication
SECRET_KEY=your-super-secret-key-change-this-in-production-min-32-chars
JWT_SECRET_KEY=your-jwt-secret-key-change-this-also-min-32-characters
ADMIN_USERNAME=admin
SESSION_COOKIE_SECURE=True
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Strict
MAX_SESSION_AGE=86400

# ============================================
# REDIS SESSION STORAGE (Production)
# ============================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# ============================================
# RATE LIMITING & DDoS PROTECTION
# ============================================
RATE_LIMIT_ENABLED=True
RATE_LIMIT_STORAGE_URL=redis://localhost:6379
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=500
LOGIN_RATE_LIMIT=5
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# DDoS Protection
AUTO_BLOCK_THRESHOLD=10
TEMPORARY_BLOCK_DURATION=600
DETECT_PORT_SCANNING=True
ENABLE_FINGERPRINTING=True
MAX_REQUESTS_PER_SECOND=10
MAX_REQUESTS_PER_MINUTE=100
MAX_CONCURRENT_CONNECTIONS=50

# ============================================
# SECURITY HEADERS
# ============================================
FORCE_HTTPS=True
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
HSTS_MAX_AGE=31536000

# CORS Configuration (Update with your frontend URL)
ALLOWED_ORIGINS=https://phishing-detector-xxxx.onrender.com,https://phishingdetector.me

# Render.com Specific
PORT=10000
PYTHON_VERSION=3.11.0

# PhishTank Integration
PHISHTANK_CACHE_HOURS=6

# Security Headers
FORCE_HTTPS=False
CONTENT_SECURITY_POLICY=default-src 'self'
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff

# Authentication
PASSWORD_MIN_LENGTH=8
SESSION_TIMEOUT_MINUTES=1440
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# Request Limits
MAX_CONTENT_LENGTH=1048576
MAX_URL_LENGTH=2048
REQUEST_TIMEOUT=30

# Logging
LOG_LEVEL=INFO
LOG_FILE=security.log

# Admin Credentials (CHANGE THESE!)
ADMIN_USERNAME=admin
ADMIN_PASSWORD_HASH=$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5GyYqgOCkT0Ci
# Default password: phishing123
# Generate new hash with: python -c "import bcrypt; print(bcrypt.hashpw(b'your_password', bcrypt.gensalt()).decode())"

# Database (for future expansion)
DATABASE_URL=sqlite:///phishing_detector.db

# Environment
FLASK_ENV=development
DEBUG=False
